# Прогнозирование заказов такси

[ipynb](order_forecasting.ipynb)

## Цель и задачи исследования

**Заказчик исследования:** такси-компания.

**Цель:** построить модель прогнозирования количества заказов такси на следующий час.

**Критерий качества модели**: значение метрики *RMSE* на тестовой выборке (10% от исходных данных) не более 48.

**Задачи (этапы) исследования:**
1. Провести загрузку, общий обзор и подготовку данных.
2. Провести анализ данных.
3. Создать новые признаки (новые календарные признаки, "лаговые" признаки).
4. Построить модели для прогнозирования количества заказов такси.
5. Оценить лучшую модель.
6. Сформулировать общие выводы.

## Общий вывод

Мы построили модель прогнозирования количества заказов такси на следующий час.

В ходе **подготовки данных** мы:
- установили, что в датасете представлены данные с 1 марта 2018 года по 31 августа 2018 года;
- ресесемплировали данные по одному часу.

В ходе **анализа данных**:
- провели графический анализ;
- выделили тренд, сезонность и случайную компоненту;
- установили, что данные имеют ежедневную "сезонность".

При **создании новых признаков**:
- выделили значения месяца, дня, дня недели и часа;
- добавили лаги до 10 включительно;
- добавили 7-дневное скользящее среднее.

При **построении моделей для прогнозирования**:
- построили 2 референсные модели;
- перебрали 5 типов моделей с различными гиперпараметрами;
- лучшей моделью по метрике на кросс-валидации (27.1) стала модель на основе случайного леса.

Для **оценки лучшей модели**:
- рассчитали метрику RMSE на тестовой выборке - она составила 44.0, что лучше целевого значения (48) и референсных моделей;
- построили график факт/прогноз, из которого видно, что модель сильнее ошибается при больших колебаниях признака;
- выявили, что на значение целевого признака в большей степени влияет внутридневная сезонность, а также 1- и 7-часовые лаги.

**Рекомендации заказчику:**
- в целом полученная модель может использоваться для прогнозирования заказов в следующий час;
- целесообразно дополнительно изучить причины больших выбросов в последний месяц рассматриваемого временного промежутка;
- также полезным может быть добавление данных за другие годы с тем, чтобы выявить внутригодовую сезонность (если она есть).
