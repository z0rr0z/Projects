# Поиск по изображениям для фотохостинга

[ipynb](image_search.ipynb)

## Цель и задачи

**Заказчик исследования:** фотохостинг для профессиональных фотографов.

**Цель:** разработка PoC для поиска референсных фотографий для фотографов.

**Задачи (этапы) исследования:**
1. Провести загрузку и исследовательский анализ данных.
2. Подготовить данные к обучению модели, в т.ч.:
- создать список слов, которые могут попадать под юридические ограничения;
- исключить из обучающего датасета пары, которые могут попадать под юридические ограничения;
- сделать векторизацию текстового описания;
- сделать векторизацию изображений с использованием модели ResNet18;
- описать получившиеся пары векторов с точки зрения их размерностей.
3. Обучить несколько моделей.
4. Провести тестирование модели и демонстрацию ее работы.
5. Сделать общий вывод по работе.

## Навыки и инструменты

- **Python**
- **Pandas**
- **NLP (NTLK, BERT)***
- **CV (TorchVision, ResNet, CLIP)**
- **PyTorch**
- **Transformers**
- **Scikit-learn**
- **LightGBM**
- **Matplotlib**
- **Seaborn**

## Общий вывод

Мы разработали PoC для поиска референсных фотографий для фотографов в соответствии с заданием заказчика.

В ходе выполнения работы мы:
1. Провели **загрузку и общий обзор данных**.
2. Провели **исследовательский анализ**, по результатам которого:
- выяснили, что оценки соответствия описаний не сбалансированы: более представлен отрицательный класс;
- выяснили, что изображения имеют разный формат;
- использовали в качестве агрегированной оценки среднюю нормализованную оценку экспертов (там, где она есть) и оценку пользователей (там, где экспертные оценки отсутствуют);
- установили, что для некоторых идентификаторов описаний отсутствовали тексты описания, и удалили такие записи.
3. Осуществили **подготовку данных**:
- удалили из обучающей выборки 303 изображения, "нарушающие" юридические правила;
- провели векторизацию текстов с использованием предобученной модели BERT;
- провели векторизацию изображений с использованием предобученной модели ResNet-18;
- объединили векторы тестов с векторами изображений.
4. Построили несколько **моделей для предсказания соответствия описания изображению**:
- разделили данные на тренировочную и валидационную выборки и провели масштабирование признаков;
- в качестве целевой метрики выбрали MSE, т.к. в данном случае мы имеем дело с задачей регрессии;
- построили Dummy-модель и классические модели: линейную регрессию, регрессию на основе случайного леса и регрессию на основе Light GBM;
- построили модель на основе трехслойной нейросети;
- лучший результат на валидационной выборке показала модель на основе нейросети (MSE = 0.052).
5. Провели **тестирование лучшей модели** на тестовом наборе и получили следующие результаты:
- запросы, содержащие "стоп-слова", связанные с юридическими ограничениями, блокируются (как того и требует ТЗ);
- модель в целом неудовлетворительно ищет изображения по описанию;
- неудовлетворительное качество модели  может быть связано с: недостаточным объемом и дисбалансом исходных данных, неполным соответствием использованных предобученных моделей поставленной задаче, недостаточной глубиной модели регрессии.
6. Использовали **предобученную модель CLIP** для поиска сответствия текста и изображения:
- сформировали эмбеддинги изображений и описания;
- использовали семантическое сходство для сравнения эмеддингов изображения и описания;
- модель CLIP показала достаточно хорошие результаты при визуальном анализе.
