# Прогнозирование оттока клиентов для телекома

[ipynb](churn_forecasting.ipynb)

## Цель и задачи исследования

**Заказчик исследования:** оператор связи.

**Цель:** построить модель, которая будет предсказывать, разорвёт ли абонент договор.

**Критерий качества модели**: метрика ROC-AUC не менее 0.85.

**Задачи (этапы) исследования:**
1. Провести загрузку и общий обзор данных.
2. Провести первичную обработку данных.
3. Провести исследовательский анализ данных.
4. Построить модели классификации.
5. Провести тестирование лучшей модели.
6. Сформулировать общие выводы.

## Навыки и инструменты

- **Python**
- **SQL**
- **Pandas**
- **Scikit-learn**
- **LightGBM**
- **CatBoost**
- **PyTorch**
- **Matplotlib**
- **Seaborn**
- **Phik**
- **Shap**

## Общие выводы

Мы построили разные модели предсказания, разорвёт ли абонент договор.

В том числе мы:
1. Провели **загрузку и общий обзор данных**, установили, что во всех таблицах отсутствуют явные пропуски и полные дубликаты.
2. Провели **предварительную обработку** данных:
- преобразовали значения и типы данных;
- устранили неявные пропуски;
- проверили логические соответствия.
3. Мы провели **исследовательский анализ** данных:
- объединили датафреймы и заполнили образовавшиеся пропуски;
- добавили целевой признак churn, который означает, ушел ли клиент от компании, а также новый признак lifetime - "срок жизни" пользователя, исключив другие временны́е признаки;
- выявили существенный дисбаланс классов в целевом признаке;
- провели графический анализ взаимосвязи признаков с целевым и составили сравнительный портрет клиентов, по итогам установили,  что у ушедших клиентов в среднем выше "срок жизни", ежемесячные и общие платежи, также у них чаще есть супруг/супруга, они абоненты более "современные" и пользуются большим числом сервисов;
- провели корреляционный анализ, по итогам которого исключили признаки gender и monthly_charges.
4. Провели **обучение моделей**:
- разделили данные на тренировочную и тестовую выборки;
- осуществили перебор гиперпараметров для "классических" моделей: логистическая регрессия, дерево решений, случайный лес, бустинговые модели, а также построили нейросеть;
- настроили порог классификации, чтобы лучше выявлять уходящих клиентов;
- лучшая модель - CatBoost - на тестовой выборке показала ROC-AUC = 0.932, что выше требований ТЗ (0.85).
5. Провели **анализ важности признаков**, который показал, что наибольшее влияние на целевой признак оказывают продолжительность контракта, общие расходы, тип оплаты , наличие супруга/супруги и подключение телефона к нескольким линиям. При этом наибольшие прогнозируемой различия вероятности ухода в зависимости от типа оплаты наблюдаются при небольшом "сроке жизни" клиента.

**Рекомендации заказчику:**
- взять за основу разработанную модель;
- рассмотреть разработку отдельных предложений для абонентов, которые достаточно долго с компанией (3-5 лет), а также для клиентов, подключившихся недавно, но выбравших тип оплаты раз в один/два года;
- рассмотреть разработку отдельных предложений для семей;
- возможно, стоит вообще рассмотреть исключение из линейки предложений для новых клиентов вариантов с оплатой раз в один/два года;
- также возможно, стоит рассмотреть мероприятия по работе с консервативными лояльными клиентами для повышения выручки от них (разъяснения преимуществ предлагаемых сервисов и т.д.).
