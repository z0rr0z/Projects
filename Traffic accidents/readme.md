# Построение модели оценки риска ДТП для каршеринговой компании

[ipynb](traffic_accidents.ipynb)

## Цель и задачи исследования

**Заказчик исследования:** каршеринговая компания.

**Цель:** создать систему, которая могла бы оценить риск ДТП по выбранному маршруту движения.

**Задачи (этапы) исследования:**
1. Провести загрузку данных из таблиц SQL и их общий обзор
2. Провести статистический анализ факторов ДТП
3. Провести предобработку и исследовательский анализ данных
4. Провести подготовку данных для обучения модели
5. Построить не менее 3 моделей прогнозирования риска ДТП
6. Оценить лучшую модель и проанализировать важность основных факторов, влияющих на вероятность ДТП
7. Сформулировать общие выводы.

## Навыки и инструменты

- **Python**
- **SQL**
- **Pandas**
- **Scikit-learn**
- **LightGBM**
- **PyTorch**
- **Matplotlib**
- **Seaborn**
- **Phik**
- **Shap**

## Общий вывод

Мы провели анализ данных и построили модель оценки риска ДТП.

В ходе **изучения данных** установлено, что на их основе исходная задача заказчика - определение вероятности ДТП - не может быть решена, поскольку данные содержат информацию только о произошедших ДТП, а не о всех поездках. Если бы мы пытались предсказать вероятность ДТП, мы бы столкнулись с типичной "ошибкой выжившего". Поэтому мы позволили себе несколько модифицировать исходную задачу как **"определение вероятности стать виновником ДТП"**.

В ходе **статистического анализа** мы установили ряд особенностей, в т.ч.:
- в октябре наблюдается несколько более высокое количество ДТП, чем в другие месяцы;
- доля ДТП с серьезными и фатальными повреждениями выше у нетрезвых водителей;
- наибольшее число ДТП приходится на автомобили возрастом 3 года.

В ходе **предобработки и исследовательского анализа** мы:
- отобрали 6 признаков (не считая целевого at_fault): vehicle_type, vehicle_transmission, vehicle_age, county_location, weather_1, lighting;
- устранили пропуски, а также выявили выбросы в признаке vehicle_age;
- провели корреляционный анализ, показавший, что в наибольшей степени влияют на целевой признак: vehicle_age (возраст автомобиля), lighting (освещенность) и county_location (место).

При **построении и анализе моделей** мы:
- определили целевую метрику F1, поскольку исходя из поставленной задачи для заказчика важна точность определения положительного класса;
- рассмотрели 5 типов моделей (логистическая регрессия, дерево решений, случайный лес, Light GBM, нейросеть) и выбрали лучшую - случайный лес, который показал на тестовой выборке F1 = 0.7018 после тюнинга порога классификации;
- результат "тюнингованной" модели не сильно выше простого константного предсказания (клиент виноват в ДТП во всех случаях), что может быть обусловлено в т.ч. тем, что мы модифицировали исходную задачу и имеющиеся данные не вполне ей соответствуют;
- выявили, что наибольшее влияние на целевой признак оказывают признаки vehicle_type, vehicle_transmission и vehicle_age;
- дополнительно проанализировали влияние признака vehicle_age, установили, что на 2-3 летних автомобилях и автомобилях старше 12-13 лет чаще становятся виновниками ДТП.
